<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/css/profile.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/photo.css"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>Profile</title>
</head>
<body>
    
  <!-- NAVBAR -->
  <%- include('../partials/navbar', {sessione: sessione}); %>

  <!-- PROFILE SECTION -->
  <section>
    <div class="container pt-3">
      <div class="row align-items-center justify-content-between">
        <div class="col-md text-center">
          <div class="row">
            <img src="images/<%= immagine_profilo %>" class="img-fluid pb-2" alt="">
          </div>
          
            <button type="button" class="btn btn-black mb-1" data-bs-toggle="modal" data-bs-target="#profileimagechange">Change profile image</button>
          
        </div>        
        <div class="col-md">
          <% if (message) { %>
            <div style="text-align: center" class="alert alert-<%=message.type%>">
                <button type="button" class="btn btn-close" data-bs-dismiss="alert"></button>
                <strong><%= message.intro %></strong> <%= message.message %>
            </div>
          <% } %>
          <form class="form-container g-5" method="POST">
            <!-- USERNAME -->
            <div class="input-group mb-3 align-items-center justify-content-between">
              <div class="col-auto">
                <label><%= username %></label>
              </div>
              <div class="col-auto">
                <button type="button" class="btn btn-black mb-3" data-bs-toggle="modal" data-bs-target="#usernamechange">Change it</button>
              </div>
            </div>
            <!-- NAME -->
            <div class="input-group mb-3 align-items-center justify-content-between">
              <div class="col-auto">
                <label><%= nome %></label>
              </div>
              <div class="col-auto">
                <button type="button" class="btn btn-black mb-3" data-bs-toggle="modal" data-bs-target="#namechange">Change it</button>
              </div>
            </div>
            <!-- SURNAME -->
            <div class="input-group mb-3 align-items-center justify-content-between">
              <div class="col-auto">
                <label><%= cognome %></label>
              </div>
              <div class="col-auto">
                <button type="button" class="btn btn-black mb-3" data-bs-toggle="modal" data-bs-target="#surnamechange">Change it</button>
              </div>
            </div>
            <div class="input-group mb-2 align-items-center justify-content-between">
              <div class="col-auto">
                <label>Password</label>
              </div>
              <div class="col-auto">
                <button type="button" class="btn btn_psw mb-3" data-bs-toggle="modal" data-bs-target="#pswchange">Change password</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- UPLOADED FOTO SECTION -->
  <div class="container pt-3">
    <ul class="photo_ul">
      <!-- invertire ordine di stampa -->
      <% for (let i = risultati.length-1; i >= 0; i--) { %>
        <li class="photo_li">
          <img class="photo_img" src="images/<%= risultati[i].immagine %>" loading="lazy">
        </li>
      <% } %>
      <li class="photo_li"></li>
    </ul>
  </div>

  <!-- MODAL -->

  <!-- MODAL CHANGE USERNAME BUTTON -->
  <div class="modal fade" id="usernamechange" tabindex="-1" aria-labelledby="" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="">Username change</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form action="change_username" method="POST">
            <div class="form-floating mb-3">
              <input type="text" class="form-control" id="floatingNewUsername" placeholder="New username" name="newUsername">
              <label for="floatingNewUsername" class="col-form-label">New username</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-grey" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-black">Change username</button>
          </form>
        </div>
      </div>
    </div>
  </div>  

  <!-- MODAL CHANGE NAME BUTTON -->
  <div class="modal fade" id="namechange" tabindex="-1" aria-labelledby="" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="">Name change</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form action="/change_name" method="POST">
            <div class="form-floating mb-3">
              <input type="text" class="form-control" id="floatingNewName" placeholder="New name" name="newName">
              <label for="floatingNewName" class="col-form-label">New name</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-grey" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-black">Change name</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL CHANGE SURNAME BUTTON -->
  <div class="modal fade" id="surnamechange" tabindex="-1" aria-labelledby="" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="">Surname change</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form action="change_surname" method="POST">
            <div class="form-floating mb-3">
              <input type="text" class="form-control" id="floatingNewSurname" placeholder="New surname" name="newSurname">
              <label for="floatingNewSurname" class="col-form-label">New surname</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-grey" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-black">Change surname</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL CHANGE PASSWORD BUTTON -->
  <div class="modal fade" id="pswchange" tabindex="-1" aria-labelledby="" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="">Password change</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form action="/psw_change" method="POST">
            <div class="form-floating mb-3">
              <input type="password" class="form-control" id="floatingOldPsw" placeholder="Old password" name="oldPsw">
              <label for="floatingOldPsw" class="col-form-label">Old password</label>
            </div>
            <div class="form-floating mb-3">
              <input type="password" class="form-control" id="floatingNewPsw1" placeholder="New password" name="newPsw1">
              <label for="floatingNewPsw1" class="col-form-label">New password</label>
            </div>
            <div class="form-floating mb-3">
              <input type="password" class="form-control" id="floatingNewPsw2" placeholder="Repeat new password" name="newPsw2">
              <label for="floatingNewPsw2" class="col-form-label">Repeat new password</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-grey" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-black">Change password</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL PROFILE IMAGE CHANGE -->
  <div class="modal fade" id="profileimagechange" tabindex="-1" aria-labelledby="" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="">Profile image change</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form action="/profile_img_change" method="POST" enctype="multipart/form-data">
            <div class="mb-3">
              <input type="file" class="form-control" id="floatingNewImage" name="image">
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-grey" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-black">Change profile image</button>
        </div>
          </form>
      </div>
    </div>
  </div>

</body>
</html>